<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë‚˜ë§Œì˜ í–‰ìš´ ë£°ë ›</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>ë‚˜ë§Œì˜ ì•Œë¡ë‹¬ë¡ ë£°ë ›! ğŸ¡</h1>
        
        <div class="input-area">
            <label for="itemsInput">
                ë£°ë › í•­ëª© ì…ë ¥ (ì‰¼í‘œ ë˜ëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„):
            </label>
            <textarea id="itemsInput" rows="5">
ìƒí’ˆA, ìƒí’ˆB, ìƒí’ˆC, ê½, ë‹¤ì‹œ í•œ ë²ˆ, 1000ì› í• ì¸ ì¿ í°
            </textarea>
            <button id="generateButton">ë£°ë › í•­ëª© ìƒì„±</button>
        </div>
        
        <div class="roulette-wrapper">
            <div class="pointer">â–¼</div>
            
            <canvas id="rouletteCanvas" width="500" height="500"></canvas>
        </div>
        
        <div class="controls">
            <button id="spinButton" disabled>ëŒë¦¬ê¸°</button>
            <button id="resetButton" disabled>ì´ˆê¸°í™”</button>
        </div>
        
        <p id="result">ğŸ‘† í•­ëª©ì„ ì…ë ¥í•˜ê³  [ë£°ë › í•­ëª© ìƒì„±] ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
    </div>
    
    <script src="script.js"></script>
</body>
</html>

body {
    display: flex;
    justify-content: center; /* ìˆ˜í‰ ê°€ìš´ë° ì •ë ¬ */
    align-items: flex-start; /* ì„¸ë¡œ ì •ë ¬ ì‹œì‘ ìœ„ì¹˜ (ì½˜í…ì¸ ê°€ í™”ë©´ ì¤‘ì•™ì— ëª¨ì´ë„ë¡) */
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    background-color: #f4f4f9;
    font-family: 'Arial', sans-serif;
    text-align: center;
}

.container {
    width: 100%;
    max-width: 600px; /* ìµœëŒ€ ë„ˆë¹„ ì„¤ì • */
    padding: 20px;
    background: white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    border-radius: 10px;
}

h1 {
    color: #333;
}

/* í•­ëª© ì…ë ¥ ì˜ì—­ ìŠ¤íƒ€ì¼ */
.input-area {
    margin-bottom: 20px;
    text-align: left;
}

#itemsInput {
    width: 98%;
    padding: 10px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
    resize: vertical;
}

#generateButton {
    background-color: #4CAF50;
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 10px;
    font-size: 16px;
}

/* ë£°ë › ê°ì‹¸ëŠ” ì˜ì—­ (ìº”ë²„ìŠ¤ì™€ í¬ì¸í„° ì •ë ¬) */
.roulette-wrapper {
    position: relative;
    width: 500px;
    height: 500px;
    margin: 20px auto;
}

/* ë£°ë › ìº”ë²„ìŠ¤ ìŠ¤íƒ€ì¼ */
#rouletteCanvas {
    display: block;
    border: 10px solid #ddd;
    border-radius: 50%;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
    /* JavaScriptì—ì„œ transformìœ¼ë¡œ íšŒì „ ì²˜ë¦¬ */
    transition: transform 4s cubic-bezier(0.1, 0.1, 0, 1); /* ë¶€ë“œëŸ¬ìš´ ê°ì†ì„ ìœ„í•œ CSS íŠ¸ëœì§€ì…˜ */
}

/* í¬ì¸í„° (í™”ì‚´í‘œ) ìŠ¤íƒ€ì¼ */
.pointer {
    position: absolute;
    top: 0; /* ë£°ë ›ì˜ 12ì‹œ ë°©í–¥ */
    left: 50%;
    transform: translateX(-50%);
    color: #cc0000;
    font-size: 40px;
    line-height: 1;
    z-index: 10;
}

/* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.controls button {
    padding: 12px 25px;
    margin: 10px;
    font-size: 18px;
    font-weight: bold;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s;
}

#spinButton {
    background-color: #ff6347; /* í† ë§ˆí†  ìƒ‰ */
    color: white;
}

#spinButton:hover:not(:disabled) {
    background-color: #e55338;
}

#resetButton {
    background-color: #6a5acd; /* ìŠ¬ë ˆì´íŠ¸ ë¸”ë£¨ */
    color: white;
}

#resetButton:hover:not(:disabled) {
    background-color: #584aae;
}

#spinButton:disabled, #resetButton:disabled {
    background-color: #ccc;
    cursor: not-allowed;
}

#result {
    margin-top: 20px;
    font-size: 20px;
    font-weight: bold;
    color: #333;
}


const canvas = document.getElementById('rouletteCanvas');
const ctx = canvas.getContext('2d');
const itemsInput = document.getElementById('itemsInput');
const generateButton = document.getElementById('generateButton');
const spinButton = document.getElementById('spinButton');
const resetButton = document.getElementById('resetButton');
const resultDisplay = document.getElementById('result');

let options = []; // ë£°ë › í•­ëª©ì„ ì €ì¥í•  ë°°ì—´
let startAngle = 0; // ë£°ë ›ì˜ í˜„ì¬ íšŒì „ ê°ë„ (ì• ë‹ˆë©”ì´ì…˜ ìƒíƒœ ì €ì¥)
let isSpinning = false;

// ì•Œë¡ë‹¬ë¡í•œ ìƒ‰ìƒ ë°°ì—´
const colors = [
    '#FFADAD', '#FFD6A5', '#FFF3B0', '#CAFFBF', '#9BF6FF', 
    '#A0C4FF', '#BDB2FF', '#FFC6FF', '#FDFFB6', '#E4C1F9'
];

// í•­ëª©ì„ ì…ë ¥ë°›ì•„ ë£°ë › í•­ëª© ë°°ì—´ì„ ìƒì„±
function generateRoulette() {
    const input = itemsInput.value.trim();
    // ì‰¼í‘œ(,) ë˜ëŠ” ì¤„ë°”ê¿ˆ(\n)ì„ ê¸°ì¤€ìœ¼ë¡œ í•­ëª© ë¶„ë¦¬
    options = input.split(/,|\n/).map(item => item.trim()).filter(item => item.length > 0);
    
    if (options.length === 0) {
        alert('ë£°ë › í•­ëª©ì„ 1ê°œ ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        spinButton.disabled = true;
        resetButton.disabled = true;
        return;
    }
    
    // ë²„íŠ¼ í™œì„±í™”
    spinButton.disabled = false;
    resetButton.disabled = false;
    resultDisplay.textContent = 'ëŒë¦¬ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!';
    
    // ë£°ë › ê·¸ë¦¬ê¸°
    drawRoulette();
}

// ë£°ë › ê·¸ë¦¬ê¸° í•¨ìˆ˜
function drawRoulette() {
    const numSegments = options.length;
    if (numSegments === 0) return; // í•­ëª©ì´ ì—†ìœ¼ë©´ ê·¸ë¦¬ì§€ ì•ŠìŒ

    const arc = 2 * Math.PI / numSegments;
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const radius = 240;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for (let i = 0; i < numSegments; i++) {
        const angle = startAngle + i * arc;
        
        // ì•Œë¡ë‹¬ë¡í•œ ìƒ‰ìƒ ì ìš© (ìƒ‰ìƒ ë°°ì—´ì„ ìˆœí™˜í•˜ë©° ì‚¬ìš©)
        ctx.fillStyle = colors[i % colors.length];
        
        // ì„¹ì…˜ ê·¸ë¦¬ê¸°
        ctx.beginPath();
        ctx.arc(centerX, centerY, radius, angle, angle + arc, false);
        ctx.lineTo(centerX, centerY);
        ctx.fill();
        ctx.save();
        
        // í…ìŠ¤íŠ¸ ì„¤ì •
        ctx.fillStyle = '#000';
        ctx.font = 'bold 16px Arial';
        
        // í…ìŠ¤íŠ¸ë¥¼ ì„¹ì…˜ ì¤‘ì•™ì— íšŒì „í•˜ì—¬ ë°°ì¹˜
        ctx.translate(centerX, centerY);
        ctx.rotate(angle + arc / 2 + Math.PI / 2); // í…ìŠ¤íŠ¸ íšŒì „ ë° ë³´ì •
        
        // í…ìŠ¤íŠ¸ ê¸¸ì´ ì œí•œ ë° ì¤„ë°”ê¿ˆ ì²˜ë¦¬ (ê°„ë‹¨í™”)
        const text = options[i].length > 10 ? options[i].substring(0, 10) + '...' : options[i];
        
        // í…ìŠ¤íŠ¸ ì¤‘ì•™ ì •ë ¬
        ctx.textAlign = 'center';
        ctx.fillText(text, 0, -(radius * 0.8)); // ë£°ë › ê°€ì¥ìë¦¬ ì•ˆìª½ì— ìœ„ì¹˜
        ctx.restore();
    }
}

// ë£°ë › ëŒë¦¬ê¸° í•¨ìˆ˜
function spin() {
    if (isSpinning || options.length === 0) return;

    isSpinning = true;
    spinButton.disabled = true;
    resetButton.disabled = true;
    resultDisplay.textContent = 'ë£°ë ›ì´ ëŒì•„ê°€ëŠ” ì¤‘...';
    
    // ë¬´ì‘ìœ„ë¡œ 8~12ë°”í€´ + ë‹¹ì²¨ ê°ë„ íšŒì „
    const spinTurns = 8 + Math.random() * 4; 
    // ë‹¹ì²¨ ì„¹ì…˜ì„ ê²°ì •í•  ìµœì¢… ê°ë„ (0 ~ 2Ï€)
    // 12ì‹œ ë°©í–¥(í¬ì¸í„° ìœ„ì¹˜)ì„ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í•˜ê¸° ìœ„í•´ ë³´ì •
    const winningSegmentIndex = Math.floor(Math.random() * options.length);
    const winningAngleOffset = winningSegmentIndex * (2 * Math.PI / options.length);
    
    // ë£°ë ›ì˜ 0ë„(3ì‹œ)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìµœì¢… ë©ˆì¶œ ìœ„ì¹˜ ê³„ì‚°
    // í¬ì¸í„°ê°€ 12ì‹œ ë°©í–¥ì— ìˆìœ¼ë¯€ë¡œ, 90ë„(PI/2) ë³´ì • í•„ìš”
    const targetAngle = (2 * Math.PI * spinTurns) - winningAngleOffset + (Math.PI / 2);

    // CSS transformì„ ìœ„í•œ ì´ íšŒì „ ê°ë„ (deg)
    const totalRotationDeg = targetAngle * (180 / Math.PI);

    // ìº”ë²„ìŠ¤ì— íšŒì „ ì ìš©
    canvas.style.transform = `rotate(${totalRotationDeg}deg)`;
    
    // ì• ë‹ˆë©”ì´ì…˜ ì¢…ë£Œ í›„ (CSS transition ì‹œê°„ì— ë§ì¶¤)
    setTimeout(() => {
        isSpinning = false;
        resetButton.disabled = false;
        determineWinner(winningSegmentIndex);
    }, 4500); // CSS transition ì‹œê°„(4s)ë³´ë‹¤ ì•½ê°„ ê¸¸ê²Œ ì„¤ì •
}

// ë‹¹ì²¨ ê²°ê³¼ ê²°ì • ë° í‘œì‹œ
function determineWinner(index) {
    const winningOption = options[index];
    resultDisplay.textContent = `ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤! ë‹¹ì²¨ ê²°ê³¼ëŠ” [${winningOption}]ì…ë‹ˆë‹¤!`;
    
    // ìŠ¤í•€ ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™” (ìƒˆë¡œìš´ ìŠ¤í•€ì„ ìœ„í•´)
    spinButton.disabled = false; 
}


// ì´ˆê¸°í™” í•¨ìˆ˜
function resetRoulette() {
    if (isSpinning) return;
    
    // ìº”ë²„ìŠ¤ íšŒì „ì„ 0ë„ë¡œ ì´ˆê¸°í™” (ë¶€ë“œëŸ¬ìš´ ì „í™˜ì„ ìœ„í•´ ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ ì‚¬ìš©)
    canvas.style.transition = 'transform 1s ease-out';
    canvas.style.transform = 'rotate(0deg)';
    
    // ë£°ë › íšŒì „ ìƒíƒœ ì´ˆê¸°í™” í›„, ë‹¤ìŒ ìŠ¤í•€ì„ ìœ„í•´ transitionì„ ë‹¤ì‹œ ì„¤ì •
    setTimeout(() => {
        canvas.style.transition = 'transform 4s cubic-bezier(0.1, 0.1, 0, 1)';
        resultDisplay.textContent = 'ëŒë¦¬ê¸° ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”!';
        spinButton.disabled = false;
        // drawRoulette(); // í•­ëª©ì€ ìœ ì§€ë˜ë¯€ë¡œ ë‹¤ì‹œ ê·¸ë¦´ í•„ìš”ëŠ” ì—†ìŒ
    }, 1000);
}

// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°
generateButton.addEventListener('click', generateRoulette);
spinButton.addEventListener('click', spin);
resetButton.addEventListener('click', resetRoulette);

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë£°ë › ìƒì„±
generateRoulette();


